// WiFi Command Implementations for CommandParser.cpp
// Add these command recognitions to processCommand() function:
// Add after the RESET command block (around line 230):

    // WiFi ç‹€æ…‹
    if (upper == "WIFI STATUS") {
        handleWiFiStatus(response);
        return true;
    }

    // WiFi å•Ÿå‹•
    if (upper == "WIFI START") {
        handleWiFiStart(response);
        return true;
    }

    // WiFi åœæ­¢
    if (upper == "WIFI STOP") {
        handleWiFiStop(response);
        return true;
    }

    // WiFi æƒæ
    if (upper == "WIFI SCAN") {
        handleWiFiScan(response);
        return true;
    }

    // Web ä¼ºæœå™¨ç‹€æ…‹
    if (upper == "WEB STATUS") {
        handleWebStatus(response);
        return true;
    }

// Add to HELP command output (around line 340):

    response->println("");
    response->println("WiFi & Web ä¼ºæœå™¨:");
    response->println("  WIFI STATUS  - é¡¯ç¤º WiFi é€£ç·šç‹€æ…‹");
    response->println("  WIFI START   - å•Ÿå‹• WiFi");
    response->println("  WIFI STOP    - åœæ­¢ WiFi");
    response->println("  WIFI SCAN    - æƒæå¯ç”¨ç¶²è·¯");
    response->println("  WEB STATUS   - é¡¯ç¤º Web ä¼ºæœå™¨ç‹€æ…‹");

// Add these handler implementations at the end of file (before HID/BLE Response implementations):

// ==================== WiFi and Web Server Commands ====================

void CommandParser::handleWiFiStatus(ICommandResponse* response) {
    response->println("=== WiFi ç‹€æ…‹ ===");

    const WiFiSettings& settings = wifiSettingsManager.get();

    response->printf("æ¨¡å¼: %s\n", wifiManager.getModeString().c_str());
    response->printf("ç‹€æ…‹: %s\n", wifiManager.isConnected() ? "å·²é€£æ¥" : "æœªé€£æ¥");
    response->printf("IP ä½å€: %s\n", wifiManager.getIPAddress().c_str());

    if (settings.mode == WiFiMode::AP || settings.mode == WiFiMode::AP_STA) {
        response->println("");
        response->println("Access Point:");
        response->printf("  SSID: %s\n", settings.ap_ssid);
        response->printf("  Channel: %d\n", settings.ap_channel);
        response->printf("  Clients: %d\n", wifiManager.getClientCount());
    }

    if (settings.mode == WiFiMode::STA || settings.mode == WiFiMode::AP_STA) {
        response->println("");
        response->println("Station:");
        response->printf("  SSID: %s\n", settings.sta_ssid);
        response->printf("  DHCP: %s\n", settings.sta_dhcp ? "Enabled" : "Disabled");
        if (wifiManager.isConnected()) {
            response->printf("  RSSI: %d dBm\n", wifiManager.getRSSI());
        }
    }

    response->println("");
}

void CommandParser::handleWiFiStart(ICommandResponse* response) {
    response->println("ğŸ”§ å•Ÿå‹• WiFi...");

    if (wifiManager.start()) {
        response->println("âœ… WiFi å•Ÿå‹•æˆåŠŸ");
        response->printf("  IP ä½å€: %s\n", wifiManager.getIPAddress().c_str());
        response->printf("  æ¨¡å¼: %s\n", wifiManager.getModeString().c_str());
    } else {
        response->println("âŒ WiFi å•Ÿå‹•å¤±æ•—");
    }
}

void CommandParser::handleWiFiStop(ICommandResponse* response) {
    wifiManager.stop();
    response->println("âœ… WiFi å·²åœæ­¢");
}

void CommandParser::handleWiFiScan(ICommandResponse* response) {
    response->println("ğŸ” æƒæ WiFi ç¶²è·¯...");

    int n = wifiManager.scanNetworks();

    if (n <= 0) {
        response->println("âš ï¸ æœªæ‰¾åˆ°ç¶²è·¯");
        return;
    }

    response->printf("æ‰¾åˆ° %d å€‹ç¶²è·¯:\n\n", n);
    response->println("SSID                             | RSSI  | Secure");
    response->println("----------------------------------+-------+--------");

    for (int i = 0; i < n && i < 20; i++) {
        String ssid;
        int8_t rssi;
        bool secure;

        if (wifiManager.getScanResult(i, ssid, rssi, secure)) {
            char line[64];
            snprintf(line, sizeof(line), "%-32s | %4d  | %s",
                    ssid.c_str(), rssi, secure ? "Yes" : "No");
            response->println(line);
        }
    }

    response->println("");
}

void CommandParser::handleWebStatus(ICommandResponse* response) {
    response->println("=== Web ä¼ºæœå™¨ç‹€æ…‹ ===");

    response->printf("åŸ·è¡Œä¸­: %s\n", webServerManager.isRunning() ? "æ˜¯" : "å¦");
    response->printf("é€£æ¥åŸ : %d\n", wifiSettingsManager.get().web_port);
    response->printf("WebSocket å®¢æˆ¶ç«¯: %d\n", webServerManager.getWSClientCount());

    if (wifiManager.isConnected()) {
        response->println("");
        response->printf("å­˜å–ç¶²å€: http://%s/\n", wifiManager.getIPAddress().c_str());
    }

    response->println("");
}
